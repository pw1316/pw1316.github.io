---
layout: page
title: 多项式时间的素数验证
date: 2018-12-27 20:12:18 +0800
mdate: 2018-12-27 20:12:18 +0800
showbar: false
---

## 基本思路

首先给出一下引理

> 引理1： $$a$$是整数，$$n\ge 2$$是自然数，且$$a$$，$$n$$互素。那么$$n$$是素数的充要条件是：$$(X+a)^n=X^n+a(mod\ n)$$

证明：左侧二项展开，右侧移到左侧，得到$$\sum_{i=1}^{n-1}{C_i^na^{n-i}x^i}+a^n-a$$。

如果$$n$$是素数，则$$C_i^n=0(mod\ n)$$，求和部分可以被$$n$$整除，剩余部分根据费马小定理也可以被$$n$$整除，所以有：

$$
\begin{align}
(X+a)^n-X^n-a&=0(mod\ n)\\
(X+a)^n&=X^n+a(mod\ n)
\end{align}
$$

如果$$n$$是合数，令$$p$$是$$n$$的一个素因数，则有$$C_q^n\ne 0(mod\ n)$$，又因为$$n$$和$$a$$互素，所以求和项中至少有一项$$C_q^na^{n-q}x^q$$模$$n$$非0TODO